<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hotel Room Reservation System â€” Unstop SDE-3 Assessment</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React + ReactDOM CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Framer Motion (optional subtle animations) -->
  <script src="https://unpkg.com/framer-motion/dist/framer-motion.umd.js"></script>
  <style>
    :root {
      color-scheme: light dark;
    }
    body { background:
                         radial-gradient(1200px 600px at 20% -10%, rgba(59,130,246,.10), transparent),
                         radial-gradient(1200px 600px at 120% 10%, rgba(16,185,129,.10), transparent),
                         linear-gradient(180deg, rgba(255,255,255,.85), rgba(248,250,252,.85)); }
    .room-cell { transition: transform .08s ease, box-shadow .15s ease, outline-color .15s ease; }
    .room-cell:hover { transform: translateY(-1px); box-shadow: 0 8px 18px rgba(0,0,0,.08); outline: 2px solid rgba(59,130,246,.25); outline-offset: 0; }
    .glass { background: linear-gradient(135deg, rgba(255,255,255,.65), rgba(255,255,255,.45)); backdrop-filter: blur(8px); border: 1px solid rgba(148,163,184,.30); box-shadow: 0 10px 25px rgba(2,6,23,.08); }
    .dark .glass { background: linear-gradient(135deg, rgba(2,6,23,.60), rgba(15,23,42,.50)); border-color: rgba(148,163,184,.22); }
    .badge { display: inline-flex; align-items: center; gap: .375rem; padding: .25rem .5rem; border-radius: 9999px; background: rgba(15,23,42,.06); border: 1px solid rgba(148,163,184,.30); }
    .dark .badge { background: rgba(148,163,184,.15); border-color: rgba(148,163,184,.25); }
  </style>
</head>
<body class="min-h-screen text-slate-900 dark:text-slate-100">
  <div id="root" class="p-4 sm:p-6 lg:p-8 max-w-6xl mx-auto"></div>
  <script>
    const { useState, useMemo, useEffect } = React;

    function buildHotel() {
      const floors = [];
      for (let f = 1; f <= 10; f++) {
        const count = f === 10 ? 7 : 10;
        const rooms = [];
        for (let i = 1; i <= count; i++) {
          const roomNumber = f === 10 ? 1000 + i : f * 100 + i;
          rooms.push({ floor: f, index: i, number: roomNumber, occupied: false, bookedNow: false });
        }
        floors.push({ floor: f, rooms });
      }
      return floors;
    }

    function travelTimeBetween(a, b) {
      if (a.floor === b.floor) {
        return Math.abs(a.index - b.index);
      }
      return (a.index - 1) + 2 * Math.abs(a.floor - b.floor) + (b.index - 1);
    }

    function setDiameter(rooms) {
      if (rooms.length <= 1) return 0;
      let maxT = 0;
      for (let i = 0; i < rooms.length; i++) {
        for (let j = i + 1; j < rooms.length; j++) {
          const t = travelTimeBetween(rooms[i], rooms[j]);
          if (t > maxT) maxT = t;
        }
      }
      return maxT;
    }

    function bestSameFloorBooking(floors, n) {
      let best = null;
      floors.forEach(({ floor, rooms }) => {
        const available = rooms.filter(r => !r.occupied && !r.bookedNow);
        if (available.length >= n) {
          const idxs = available.map(r => r.index).sort((a,b)=>a-b);
          for (let i = 0; i + n - 1 < idxs.length; i++) {
            const first = idxs[i];
            const last = idxs[i + n - 1];
            const span = last - first;
            const chosen = available.filter(r => r.index >= first && r.index <= last)
                                     .sort((a,b)=>a.index-b.index)
                                     .slice(0, n);
            const time = setDiameter(chosen);
            const key = { time, chosen };
            if (!best || time < best.time || (time === best.time && (floor < best.floor || (floor === best.floor && first < best.first)))) {
              best = { ...key, floor, first };
            }
          }
        }
      });
      return best ? best.chosen : null;
    }

    function bestCrossFloorBooking(floors, n) {
      const all = [];
      for (let a = 1; a <= 10; a++) {
        for (let b = a; b <= 10; b++) {
          for (let t = 1; t <= 10; t++) {
            const band = [];
            for (let f = a; f <= b; f++) {
              const maxIndex = f === 10 ? Math.min(t, 7) : t;
              const rooms = floors[f-1].rooms
                .filter(r => !r.occupied && !r.bookedNow && r.index <= maxIndex)
                .sort((x,y)=>x.index - y.index);
              band.push(...rooms);
            }
            if (band.length >= n) {
              band.sort((x,y)=> (x.index - y.index) || (x.floor - y.floor));
              const chosen = band.slice(0, n);
              const time = setDiameter(chosen);
              all.push({ time, chosen, a, b, t });
            }
          }
        }
      }
      if (all.length === 0) return null;
      all.sort((x,y)=> x.time - y.time || (x.a - y.a) || (x.b - y.b) || (x.t - y.t));
      return all[0].chosen;
    }

    function deepCloneHotel(h) {
      return h.map(f => ({ floor: f.floor, rooms: f.rooms.map(r => ({ ...r })) }));
    }

    function App() {
      const [hotel, setHotel] = useState(buildHotel());
      const [requested, setRequested] = useState(4);
      const [lastBooked, setLastBooked] = useState([]);
      const [lastTime, setLastTime] = useState(null);

      const totalAvailable = useMemo(() => hotel.reduce((acc, f) => acc + f.rooms.filter(r => !r.occupied && !r.bookedNow).length, 0), [hotel]);

      const handleRandomOccupancy = () => {
        const cloned = deepCloneHotel(hotel);
        cloned.forEach(f => {
          f.rooms.forEach(r => {
            r.bookedNow = false;
            r.occupied = Math.random() < 0.35;
          });
        });
        setHotel(cloned);
        setLastBooked([]);
        setLastTime(null);
      };

      const handleResetAll = () => {
        setHotel(buildHotel());
        setLastBooked([]);
        setLastTime(null);
      };

      const handleBook = () => {
        const n = Math.max(1, Math.min(5, Number(requested) || 1));
        if (totalAvailable < n) {
          alert(`Only ${totalAvailable} rooms available.`);
          return;
        }
        const cloned = deepCloneHotel(hotel);

        const same = bestSameFloorBooking(cloned, n);
        let chosen = null;
        if (same) {
          chosen = same;
        } else {
          chosen = bestCrossFloorBooking(cloned, n);
        }
        if (!chosen) {
          alert("Couldn't find a valid combination.");
          return;
        }
        const time = setDiameter(chosen);

        const picked = [];
        cloned.forEach(f => f.rooms.forEach(r => {
          const hit = chosen.find(c => c.floor === r.floor && c.index === r.index);
          if (hit) {
            r.bookedNow = true;
            r.occupied = true;
            picked.push(r);
          } else {
            r.bookedNow = false;
          }
        }));
        setHotel(cloned);
        setLastBooked(picked);
        setLastTime(time);
      };

      const bookedCount = lastBooked.length;

      return (
        React.createElement('div', { className: 'space-y-6' },
          React.createElement('div', { className: 'flex items-start justify-between gap-4' },
            React.createElement('div', null,
              React.createElement('h1', { className: 'text-2xl sm:text-3xl font-extrabold tracking-tight bg-gradient-to-r from-slate-900 to-blue-700 dark:from-slate-100 dark:to-teal-300 bg-clip-text text-transparent' }, 'Hotel Room Reservation System'),
              React.createElement('p', { className: 'text-sm text-slate-500 mt-1' }, 'SDE-3 Assessment Â· Floors 1â€“9: 10 rooms each, Floor 10: 7 rooms. Stairs/Lift on the left.')
            ),
            React.createElement('div', { className: 'flex items-center gap-2' },
              React.createElement('button', { onClick: handleRandomOccupancy, className: 'inline-flex items-center gap-2 px-3 py-2 rounded-2xl bg-slate-900 text-white shadow hover:opacity-90 active:scale-[.99]' }, 'ðŸŽ² Random Occupancy' ),
              React.createElement('button', { onClick: handleResetAll, className: 'inline-flex items-center gap-2 px-3 py-2 rounded-2xl bg-slate-200 hover:bg-slate-300 active:scale-[.99]' }, 'ðŸ”„ Reset' )
            )
          ),
          React.createElement('div', { className: 'grid sm:grid-cols-3 gap-4' },
            React.createElement('div', { className: 'p-4 rounded-2xl glass' },
              React.createElement('label', { className: 'text-sm text-slate-600' }, 'Number of rooms to book (1â€“5)'),
              React.createElement('input', {
                type: 'number', min: 1, max: 5, value: requested,
                onChange: (e) => setRequested(e.target.value),
                className: 'mt-2 w-full px-3 py-2 rounded-xl bg-white/70 dark:bg-slate-800/50 border border-slate-300 dark:border-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-400'
              }),
              React.createElement('button', { onClick: handleBook, className: 'mt-3 w-full inline-flex items-center justify-center gap-2 px-3 py-2 rounded-2xl bg-blue-600 text-white shadow hover:bg-blue-700 active:scale-[.99]' }, 'âœ¨ Book Optimally' )
            ),
            React.createElement('div', { className: 'p-4 rounded-2xl glass flex flex-col justify-center' },
              React.createElement('div', { className: 'text-sm text-slate-600' }, 'Travel time between first and last room'),
              React.createElement('div', { className: 'mt-2 text-2xl font-semibold' }, lastTime === null ? 'â€”' : `${lastTime} min`)
            ),
            React.createElement('div', { className: 'p-4 rounded-2xl glass flex flex-col justify-center' },
              React.createElement('div', { className: 'text-sm text-slate-600' }, 'Available rooms'),
              React.createElement('div', { className: 'mt-2 text-2xl font-semibold' }, totalAvailable)
            )
          ),
          React.createElement('div', { className: 'flex items-center gap-3 text-sm text-slate-600' },
            React.createElement('div', { className: 'flex items-center gap-2 badge' },
              React.createElement('span', { className: 'inline-block w-3 h-3 rounded-full ring-1 ring-slate-300 bg-white ring-inset' }), 'Available'
            ),
            React.createElement('div', { className: 'flex items-center gap-2 badge' },
              React.createElement('span', { className: 'inline-block w-3 h-3 rounded-full ring-1 ring-slate-300 bg-yellow-100 ring-inset' }), 'Booked (this action)'
            ),
            React.createElement('div', { className: 'flex items-center gap-2 badge' },
              React.createElement('span', { className: 'inline-block w-3 h-3 rounded-full ring-1 ring-slate-300 bg-slate-300 ring-inset' }), 'Occupied'
            )
          ),
          React.createElement('div', { className: 'mt-2 rounded-2xl overflow-hidden glass' },
            hotel.slice().reverse().map((f) => {
              const label = f.floor === 10 ? '10' : String(f.floor);
              const maxCols = f.floor === 10 ? 7 : 10;
              return React.createElement('div', { key: f.floor, className: 'grid grid-cols-[80px_1fr] border-b border-slate-100' },
                React.createElement('div', { className: 'px-3 py-2 text-sm font-semibold bg-slate-50/70 dark:bg-slate-800/40 flex items-center justify-between' },
                  React.createElement('span', null, `Floor ${label}`)
                ),
                React.createElement('div', { className: `grid grid-cols-${maxCols} gap-px p-2 bg-slate-200/50` },
                  f.rooms.map((r) => {
                    const clsBase = 'room-cell aspect-[5/3] rounded-lg flex items-center justify-center text-xs sm:text-sm font-medium ring-1 ring-slate-300 hover:ring-blue-300';
                    const stateClass = r.bookedNow
                      ? 'bg-yellow-100 text-yellow-900'
                      : (r.occupied ? 'bg-slate-300 text-slate-700' : 'bg-white');
                    return React.createElement('div', { key: r.number, className: `${clsBase} ${stateClass}`, title: `Room ${r.number}` }, r.number);
                  })
                )
              );
            })
          ),
          React.createElement('div', { className: 'text-xs text-slate-500 mt-4' },
            'Rules implemented: (1) Try to book all on one floor using minimal span; (2) Otherwise, choose a minimal-diameter set across floors by searching floor bands and index thresholds, respecting stairs/lift on the left and travel times (1 min per adjacent room horizontally; 2 min per floor vertically).')
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>
